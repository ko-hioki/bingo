<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bingo抽選サービス</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font: Inter from Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f4f8;
            color: #1e293b;
        }
        .main-number {
            font-size: 8rem; /* 大きなフォントサイズ */
            line-height: 1;
            font-weight: 700;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }
        @media (max-width: 768px) {
            .main-number {
                font-size: 5rem;
            }
        }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen p-4">
    <div class="flex flex-col md:flex-row w-full max-w-6xl h-full">
        <!-- 左側のコンテナ：抽選番号とボタン -->
        <div class="bg-white p-8 md:p-12 rounded-3xl shadow-2xl w-full md:w-1/2 max-w-xl text-center md:mr-4 mb-4 md:mb-0 flex flex-col justify-center">
            <h1 class="text-4xl md:text-5xl font-bold mb-8 text-indigo-600">Bingo抽選サービス</h1>

            <!-- 現在の抽選番号表示エリア -->
            <div class="bg-gray-100 rounded-2xl p-8 mb-8 border-4 border-dashed border-gray-300">
                <div id="current-number" class="main-number text-indigo-800">--</div>
                <p id="message-area" class="mt-4 text-lg text-gray-600"></p>
            </div>
            
            <!-- コントロールボタン -->
            <div class="flex flex-col sm:flex-row justify-center gap-4">
                <button id="draw-button" class="bg-indigo-600 text-white font-bold py-4 px-8 rounded-full shadow-lg hover:bg-indigo-700 transition duration-300 transform hover:scale-105 disabled:bg-gray-400 disabled:shadow-none disabled:transform-none">
                    次の数字を引く
                </button>
                <button id="reset-button" class="bg-red-500 text-white font-bold py-4 px-8 rounded-full shadow-lg hover:bg-red-600 transition duration-300 transform hover:scale-105 disabled:bg-gray-400 disabled:shadow-none disabled:transform-none">
                    リセット
                </button>
            </div>
        </div>
        
        <!-- 右側のコンテナ：抽選済み数字リスト (ビンゴカード形式) -->
        <div class="bg-white p-8 md:p-12 rounded-3xl shadow-2xl w-full md:w-1/2 max-w-2xl text-center flex flex-col">
            <h2 class="text-2xl font-bold mb-4 text-gray-700">抽選済み数字一覧</h2>
            <div class="grid grid-cols-5 gap-4">
                <!-- 各列のヘッダーと数字表示エリア -->
                <div id="col-b">
                    <div class="text-xl font-bold text-gray-600 mb-2">B</div>
                    <!-- 数字がここに表示されます -->
                </div>
                <div id="col-i">
                    <div class="text-xl font-bold text-gray-600 mb-2">I</div>
                    <!-- 数字がここに表示されます -->
                </div>
                <div id="col-n">
                    <div class="text-xl font-bold text-gray-600 mb-2">N</div>
                    <!-- 数字がここに表示されます -->
                </div>
                <div id="col-g">
                    <div class="text-xl font-bold text-gray-600 mb-2">G</div>
                    <!-- 数字がここに表示されます -->
                </div>
                <div id="col-o">
                    <div class="text-xl font-bold text-gray-600 mb-2">O</div>
                    <!-- 数字がここに表示されます -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // DOM要素の取得
        const currentNumberEl = document.getElementById('current-number');
        const drawButton = document.getElementById('draw-button');
        const resetButton = document.getElementById('reset-button');
        const messageArea = document.getElementById('message-area');

        // 列のDOM要素を取得
        const colBEl = document.getElementById('col-b');
        const colIEl = document.getElementById('col-i');
        const colNEl = document.getElementById('col-n');
        const colGEl = document.getElementById('col-g');
        const colOEl = document.getElementById('col-o');

        // 定数と変数
        const BINGO_RANGE = 75; // Bingoの数字の範囲 (1〜75)
        const LOCAL_STORAGE_KEY = 'bingoDrawnNumbers';
        let drawnNumbers = [];

        /**
         * アプリケーションの初期化
         */
        document.addEventListener('DOMContentLoaded', () => {
            loadState();
            updateUI();

            // イベントリスナーの設定
            drawButton.addEventListener('click', drawNumber);
            resetButton.addEventListener('click', resetGame);
        });

        /**
         * ローカルストレージから状態を読み込む
         */
        function loadState() {
            try {
                const storedData = localStorage.getItem(LOCAL_STORAGE_KEY);
                if (storedData) {
                    const data = JSON.parse(storedData);
                    if (Array.isArray(data) && data.every(num => typeof num === 'number' && num > 0 && num <= BINGO_RANGE)) {
                        drawnNumbers = data;
                    }
                }
            } catch (e) {
                console.error('ローカルストレージからの読み込みに失敗しました。', e);
            }
        }

        /**
         * ローカルストレージに状態を保存する
         */
        function saveState() {
            try {
                localStorage.setItem(LOCAL_STORAGE_KEY, JSON.stringify(drawnNumbers));
            } catch (e) {
                console.error('ローカルストレージへの保存に失敗しました。', e);
            }
        }

        /**
         * 数字に対応するBingoの文字（B, I, N, G, O）を取得する
         * @param {number} number - Bingoの数字
         * @returns {string} - 対応する文字
         */
        function getBingoLetter(number) {
            if (number >= 1 && number <= 15) {
                return 'B';
            } else if (number >= 16 && number <= 30) {
                return 'I';
            } else if (number >= 31 && number <= 45) {
                return 'N';
            } else if (number >= 46 && number <= 60) {
                return 'G';
            } else if (number >= 61 && number <= 75) {
                return 'O';
            }
            return '';
        }

        /**
         * 抽選ボタンがクリックされたときに実行される関数
         */
        function drawNumber() {
            // 全ての数字が抽選済みかチェック
            if (drawnNumbers.length >= BINGO_RANGE) {
                currentNumberEl.textContent = '--';
                messageArea.textContent = '抽選が終了しました！';
                drawButton.disabled = true;
                return;
            }

            let newNumber;
            do {
                newNumber = Math.floor(Math.random() * BINGO_RANGE) + 1;
            } while (drawnNumbers.includes(newNumber));

            drawnNumbers.push(newNumber);
            
            currentNumberEl.textContent = `${getBingoLetter(newNumber)}-${newNumber}`;
            messageArea.textContent = '';
            
            updateBingoCardGrid();
            
            saveState();

            if (drawnNumbers.length >= BINGO_RANGE) {
                drawButton.disabled = true;
                messageArea.textContent = '抽選が終了しました！';
            }
        }

        /**
         * ビンゴカードのグリッドをUIに描画する
         */
        function updateBingoCardGrid() {
            // すべての列を一度クリア
            colBEl.innerHTML = '<div class="text-xl font-bold text-gray-600 mb-2">B</div>';
            colIEl.innerHTML = '<div class="text-xl font-bold text-gray-600 mb-2">I</div>';
            colNEl.innerHTML = '<div class="text-xl font-bold text-gray-600 mb-2">N</div>';
            colGEl.innerHTML = '<div class="text-xl font-bold text-gray-600 mb-2">G</div>';
            colOEl.innerHTML = '<div class="text-xl font-bold text-gray-600 mb-2">O</div>';

            const drawnSet = new Set(drawnNumbers);

            for (let i = 1; i <= BINGO_RANGE; i++) {
                const numberEl = document.createElement('div');
                const isDrawn = drawnSet.has(i);

                // カード上では文字は不要なので数字のみ表示
                numberEl.textContent = i;
                
                // クラスに余白を追加
                const baseClasses = 'flex items-center justify-center font-semibold text-base rounded-lg py-2 px-1 text-center mb-2';
                const drawnClasses = 'bg-indigo-400 text-white shadow-md transform scale-105 transition duration-200';
                const undrawnClasses = 'bg-gray-200 text-gray-500';

                numberEl.className = `${baseClasses} ${isDrawn ? drawnClasses : undrawnClasses}`;
                
                // 数字に応じて適切な列に追加
                if (i >= 1 && i <= 15) {
                    colBEl.appendChild(numberEl);
                } else if (i >= 16 && i <= 30) {
                    colIEl.appendChild(numberEl);
                } else if (i >= 31 && i <= 45) {
                    colNEl.appendChild(numberEl);
                } else if (i >= 46 && i <= 60) {
                    colGEl.appendChild(numberEl);
                } else if (i >= 61 && i <= 75) {
                    colOEl.appendChild(numberEl);
                }
            }
        }
        
        /**
         * UIの初期状態を設定する
         */
        function updateUI() {
            if (drawnNumbers.length > 0) {
                const lastNumber = drawnNumbers[drawnNumbers.length - 1];
                currentNumberEl.textContent = `${getBingoLetter(lastNumber)}-${lastNumber}`;
            } else {
                currentNumberEl.textContent = '--';
            }
            updateBingoCardGrid();

            if (drawnNumbers.length >= BINGO_RANGE) {
                drawButton.disabled = true;
                messageArea.textContent = '抽選が終了しました！';
            }
        }

        /**
         * ゲームをリセットする
         */
        function resetGame() {
            try {
                localStorage.removeItem(LOCAL_STORAGE_KEY);
            } catch (e) {
                console.error('ローカルストレージの削除に失敗しました。', e);
            }

            drawnNumbers = [];
            
            currentNumberEl.textContent = '--';
            messageArea.textContent = 'ゲームがリセットされました。';
            drawButton.disabled = false;
            
            updateBingoCardGrid();
        }
    </script>
</body>
</html>
